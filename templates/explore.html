<!DOCTYPE html>
<html lang='en' data-theme="light">
<head>
    <meta charset='utf-8'>
    <title>Explore</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" href="/static/icons/Robotics.png" type="image/x-icon">
</head>
<body> <!--style="background-color:#ffdbfe;"-->
   <div class="navigation">
    {% if user %}
        <h1 class="nav-title">< {{ user }} > Explore</h1>
    {% else %}
        <h1 class="nav-title">Explore</h1>
    {% endif %}
        <div class="nav-links">
            <a href="{{ url_for('index') }}">Home</a>
            <a href="{{ url_for('major_plan') }}">Major Plan</a>
            <a href="{{ url_for('explore') }}">Explore</a>
        </div>
    </div>
    <div class="explore-parent-container">
    <!-- Left scrollable panel -->
    <div class="explore-left-panel">
        <div class="map-container">
            {% for d in data %}
            <div class="topic" data-popup="{{ data[d]['alt_name'] }}">
                <img src="{{ url_for('static', filename='icons/' + data[d]['alt_name'] + '.png') }}" class="icon" alt="{{ d }}">
                <span>{{ d }}</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Right panel -->
    <div class="explore-right-panel">
        <div class="explore-message">
            There is always more to explore! <br> 
            To the left is a list of some popular topics in CS. <br>
            Click on a topic to learn more.
        </div>

        <!-- Popups (hidden by default) -->
        {% for d in data %}
        <div class="explore-popup hidden" id="{{ data[d]['alt_name'] }}">
            <div class="explore-popup-header">
                <button class="explore-close-button"> × </button>
            </div>
            <div class="popup-body-wrap">
                <div style="padding:10px;">
                    <h2>{{ d }}!</h2>
                    <p>{{ data[d]['blurb'] }}</p>
                    {% if data[d]['instructors'][0]['name'] %}
                        <h2>Relevant instructors at Wellesley</h2>
                        {% for instructor in data[d]['instructors'] %}
                            <p><a href="{{ instructor['link'] }}" target="_blank">{{ instructor['name'] }}</a>: "{{ instructor['bio'] }}"</p>
                        {% endfor %}
                    {% endif %}
                    {% if data[d]['courses'][0]['course_code'] %}
                        <h2>Take a Course!</h2>
                        {% for course in data[d]['courses'] %}
                            <p><a href="{{ course['link'] }}" target="_blank">{{ course['course_code'] }}</a>: {{ course['course_name'] }} — <i>{{ course['type'] }}</i></p>
                        {% endfor %}
                    {% endif %}
                    {% if data[d]['opportunities'][0]['title'] %}
                        <h2>Opportunities</h2>
                        {% for opportunity in data[d]['opportunities'] %}
                            <p><a href="{{ opportunity['link'] }}" target="_blank">{{ opportunity['title'] }}</a>: {{ opportunity['about'] }}</p>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<!--popup script; could probably refactor and move to a diff file later-->
<script>
    // Open popup when clicking a topic
    document.querySelectorAll(".topic").forEach(topic => {
        topic.addEventListener("click", (e) => {
            e.stopPropagation();

            // Close all popups first
            document.querySelectorAll(".explore-popup").forEach(popup => {
                popup.classList.add("hidden");
            });

            // Open selected popup
            const popupId = topic.dataset.popup;
            const popup = document.getElementById(popupId);

            if (popup) {
                popup.classList.remove("hidden");
            }
        });
    });

    // Close popup when clicking outside
    document.addEventListener("click", () => {
        document.querySelectorAll(".explore-popup").forEach(popup => {
            popup.classList.add("hidden");
        });
    });

    // Prevent clicks inside popup from closing it
    document.querySelectorAll(".explore-popup").forEach(popup => {
        popup.addEventListener("click", (e) => {
            e.stopPropagation();
        });
    });

    // Close button
    document.querySelectorAll(".explore-close-button").forEach(btn => {
        btn.addEventListener("click", (e) => {
            e.stopPropagation();
            btn.closest(".explore-popup").classList.add("hidden");
        });
    });
</script>

</body>
</html>